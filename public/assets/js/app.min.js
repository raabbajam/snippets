function Snippet(e,t,n,i,a){this.url=e.url||"",this.cm=t,this.elSyntax=n,this.elTheme=i,this.elInfo=a,this.path=window.location.pathname.split("/").pop(),this.delay=e.delay||2e3,this.syntax=e.syntax||"javascript",this.theme=e.theme||"monokai",this.timer,this.init()}Snippet.prototype.init=function(){var e=this;e.elInfo.timeago(),e.getSnippet(function(){e.afterInit()})},Snippet.prototype.afterInit=function(){var e=this;e.cm.on("change",function(){e.updateSnippet()}),e.elSyntax.change(function(){e.syntax=e.elSyntax.val(),e.cm.setOption("mode",e.syntax),e.updateSnippet()}),e.elTheme.change(function(){e.theme=e.elTheme.val(),e.cm.setOption("theme",e.theme),e.updateSnippet()})},Snippet.prototype.getSnippet=function(e){var t=this;$.get("snippets/api/service/v1/snippet/"+t.path,function(n){n.error===!1?console.log(n.message):(null!==n.snippet&&(t.syntax=n.snippet.syntax,t.theme=n.snippet.theme,t.cm.setOption("mode",t.syntax),t.cm.setOption("theme",t.theme),t.cm.setValue(n.snippet.body)),"function"==typeof e&&e())})},Snippet.prototype.updateSnippet=function(){var e=this;clearTimeout(e.timer),e.timer=setTimeout(function(){var t=e.cm.getValue(),n={body:t,syntax:e.syntax,theme:e.theme};$.ajax({url:"snippets/api/service/v1/snippet/"+e.path,method:"put",data:n}).done(function(t){t.error===!0?console.log(t.message):(e.elInfo.removeData("timeago").attr("title",t.updated_at).timeago(),$(".info small").html(t.updated_at_date))})},e.delay)},$(function(){var e=CodeMirror.fromTextArea(document.getElementById("code"),{lineNumbers:!0,theme:"monokai"}),t=(new gnMenu(document.getElementById("gn-menu")),new NLForm(document.getElementById("nl-form")),$("#syntax")),n=$("#theme"),i=$("#info");snippet=new Snippet({},e,t,n,i)}),function(){function e(){var e=function(){i.animations&&this.removeEventListener(r,e),t()};window.addEventListener("scroll",n),classie.add(a,"loading"),i.animations?a.addEventListener(r,e):e()}function t(){var e=function(e){var t=0,s=setInterval(function(){if(t=Math.min(t+.05*Math.random(),1),e.setProgress(t),1===t){classie.remove(a,"loading"),classie.add(a,"loaded"),clearInterval(s);var m=function(e){if(i.animations){if(e.target!==o)return;this.removeEventListener(r,m)}classie.add(document.body,"layout-switch"),window.removeEventListener("scroll",n)};i.animations?o.addEventListener(r,m):m()}},80)};s.setProgressFn(e)}function n(){window.scrollTo(0,0)}var i={animations:Modernizr.cssanimations},a=document.getElementById("ip-container"),o=a.querySelector("header.ip-header"),s=new PathLoader(document.getElementById("ip-loader-circle")),m={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},r=m[Modernizr.prefixed("animation")];e()}();